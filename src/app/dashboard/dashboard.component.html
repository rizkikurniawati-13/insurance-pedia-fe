<div class="d-flex" style="height: 100vh;">
  <!-- Sidebar -->
  <app-sidebar style="width: 250px;"></app-sidebar>
  <!-- dashboard.component.html (Bootstrap version with sidebar layout) -->
  <div class="container-fluid" [ngStyle]="{ 'margin-left': collapsed ? '-500px' : '-250px' }">
    <div class="row">
      <!-- Main Content -->
      <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 mb-3">
          <h2 class="h4 text-primary fw-bold"><i class="fas fa-chart-line me-2"></i>Dashboard Statistik Industri
            Asuransi</h2>
        </div>

        <!-- Upload Form -->
        <div class="card shadow-sm mb-4">
          <div class="card-body">
            <h5 class="card-title text-primary mb-3"><i class="fas fa-upload me-2"></i>Upload Data Excel</h5>
            <form (ngSubmit)="upload()" class="row g-3">
              <div class="col-md-4">
                <label for="periode" class="form-label">Periode</label>
                <input type="date" id="periode" [(ngModel)]="periode" name="periode" class="form-control" required />
              </div>
              <div class="col-md-4">
                <label for="createdBy" class="form-label">Created By</label>
                <input type="text" id="createdBy" [(ngModel)]="createdBy" name="createdBy" class="form-control"
                  required />
              </div>
              <div class="col-md-4">
                <label for="file" class="form-label">File Excel (.xlsx)</label>
                <input type="file" id="file" (change)="onFileChange($event)" accept=".xlsx" class="form-control"
                  required />
              </div>
              <div class="col-12">
                <button type="submit" class="btn btn-primary w-100" [disabled]="!file || !periode || !createdBy">
                  ‚¨ÜÔ∏è Upload dan Tampilkan Data
                </button>
              </div>
            </form>

            <div *ngIf="message" class="alert alert-success mt-3">‚úÖ {{ message }}</div>
            <div *ngIf="error" class="alert alert-danger mt-3">‚ùå {{ error }}</div>
          </div>
        </div>

        <!-- Charts -->
        <div class="row">
          <div class="col-md-6 mb-4">
            <div class="card shadow-sm">
              <div class="card-body" [ngStyle]="{ width: '800px', height: '500px' }">
                <h6 class="card-title text-primary">üè≠ Jumlah Industri</h6>
                <canvas baseChart [data]="chartJumlahIndustri" [options]="chartJumlahIndustriOptions"
                  [type]="'bar'"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-4">
            <div class="card shadow-sm">
              <div class="card-body" [ngStyle]="{ width: '800px', height: '500px' }">
                <h6 class="card-title text-primary">üí∞ Aset vs Liabilitas</h6>
                <canvas baseChart [data]="chartAsetLiabilitas" [options]="chartAsetLiabilitasOptions" [type]="'bar'"
                  [ngStyle]="{ width: '800px', height: '500px'}"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-4">
            <div class="card shadow-sm">
              <div class="card-body" [ngStyle]="{ width: '800px', height: '500px' }">
                <h6 class="card-title text-primary">üìâ Premi vs Klaim</h6>
                <canvas baseChart [data]="chartPremiKlaim" [options]="chartPremiKlaimOptions" [type]="'bar'"
                  [ngStyle]="{ width: '800px', height: '500px'}"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-4">
            <div class="card shadow-sm">
              <div class="card-body" [ngStyle]="{ width: '800px', height: '500px' }">
                <h6 class="card-title text-primary">üç∞ Komposisi Industri</h6>
                <canvas baseChart [data]="chartKomposisiKategori" [options]="chartKomposisiKategoriOptions"
                  [type]="'pie'" [ngStyle]="{ width: '800px', height: '500px'}"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-4">
            <div class="card shadow-sm">
              <div class="card-body" [ngStyle]="{ width: '800px', height: '500px' }">
                <h6 class="card-title text-primary">üìà Tren Premi & Klaim</h6>
                <canvas baseChart [data]="chartTrendPremiKlaim" [options]="chartTrendOptions" [type]="'line'"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-4">
            <!-- Data Table -->
            <div class="card shadow-sm mb-5 table-wrapper" *ngIf="groupedData.length > 0">
              <div class="card-body">
                <h5 class="card-title text-primary fw-bold mb-4">üìã Tabel Data Ringkasan</h5>
                <div class="table-responsive">
                  <table class="table table-bordered modern-table">
                    <thead>
                      <tr class="main-header">
                        <th rowspan="2" (click)="setOrder('komponen')">
                          Komponen
                          <i [ngClass]="getSortIcon('komponen')"></i>
                        </th>
                        <th colspan="2" (click)="setOrder('jumlahIndustriKonv')">
                          Jumlah Industri (Unit)
                          <i [ngClass]="getSortIcon('jumlahIndustriKonv')"></i>
                        </th>
                        <th colspan="2" (click)="setOrder('asetKonv')">
                          Aset (Miliar Rp)
                          <i [ngClass]="getSortIcon('asetKonv')"></i>
                        </th>
                        <th colspan="2" (click)="setOrder('liabilitasKonv')">
                          Liabilitas (Miliar Rp)
                          <i [ngClass]="getSortIcon('liabilitasKonv')"></i>
                        </th>
                        <th colspan="2" (click)="setOrder('ekuitasKonv')">
                          Ekuitas (Miliar Rp)
                          <i [ngClass]="getSortIcon('ekuitasKonv')"></i>
                        </th>
                        <th colspan="2" (click)="setOrder('pinjamanKonv')">
                          Pinjaman (Miliar Rp)
                          <i [ngClass]="getSortIcon('pinjamanKonv')"></i>
                        </th>
                        <th colspan="2" (click)="setOrder('premiKonv')">
                          Premi (Miliar Rp)
                          <i [ngClass]="getSortIcon('premiKonv')"></i>
                        </th>
                        <th colspan="2" (click)="setOrder('klaimKonv')">
                          Klaim (Miliar Rp)
                          <i [ngClass]="getSortIcon('klaimKonv')"></i>
                        </th>
                      </tr>
                      <tr class="sub-header">
                        <th class="konv">Konvensional</th>
                        <th class="syariah">Syariah</th>
                        <th class="konv">Konvensional</th>
                        <th class="syariah">Syariah</th>
                        <th class="konv">Konvensional</th>
                        <th class="syariah">Syariah</th>
                        <th class="konv">Konvensional</th>
                        <th class="syariah">Syariah</th>
                        <th class="konv">Konvensional</th>
                        <th class="syariah">Syariah</th>
                        <th class="konv">Konvensional</th>
                        <th class="syariah">Syariah</th>
                        <th class="konv">Konvensional</th>
                        <th class="syariah">Syariah</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let row of groupedData | orderBy:order:reverse">
                        <td class="text-start fw-medium">{{ row.komponen }}</td>
                        <td class="text-end">{{ row.jumlahIndustriKonv ?? '‚Äì' }}</td>
                        <td class="text-end">{{ row.jumlahIndustriSyariah ?? '‚Äì' }}</td>
                        <td class="text-end">{{ row.asetKonv | number:'1.0-0' }}</td>
                        <td class="text-end">{{ row.asetSyariah | number:'1.0-0' }}</td>
                        <td class="text-end">{{ row.liabilitasKonv | number:'1.0-0' }}</td>
                        <td class="text-end">{{ row.liabilitasSyariah | number:'1.0-0' }}</td>
                        <td class="text-end">{{ row.ekuitasKonv | number:'1.0-0' }}</td>
                        <td class="text-end">{{ row.ekuitasSyariah | number:'1.0-0' }}</td>
                        <td class="text-end">{{ row.pinjamanKonv | number:'1.0-0' }}</td>
                        <td class="text-end">{{ row.pinjamanSyariah | number:'1.0-0' }}</td>
                        <td class="text-end">{{ row.premiKonv | number:'1.0-0' }}</td>
                        <td class="text-end">{{ row.premiSyariah | number:'1.0-0' }}</td>
                        <td class="text-end">{{ row.klaimKonv | number:'1.0-0' }}</td>
                        <td class="text-end">{{ row.klaimSyariah | number:'1.0-0' }}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>
</div>