<div class="d-flex vh-100 bg-light">
  <app-sidebar style="width: 250px;"></app-sidebar>

  <main class="flex-grow-1 p-4 overflow-auto">
    <div class="container my-4">
      <h1 class="mb-4 text-center text-primary">Insurance Business Process</h1>

      <div class="graph-card p-4 rounded shadow bg-white">
        <h4 class="mb-3 text-secondary">Akseptasi / Pertanggungan</h4>

        <ngx-graph class="chart-container" [links]="hierarchialGraph.links" [nodes]="hierarchialGraph.nodes"
          [legend]="true" [curve]="curve" [draggingEnabled]="false" layout="dagre" (select)="onNodeClick($event.node)">

          <!-- Panah Arah -->
          <ng-template #defsTemplate>
            <svg:marker id="arrow" viewBox="0 -5 10 10" refX="8" refY="0" markerWidth="4" markerHeight="4"
              orient="auto">
              <svg:path d="M0,-5L10,0L0,5" class="arrow-head" fill="#333" />
            </svg:marker>
          </ng-template>

          <!-- Node -->
          <ng-template #nodeTemplate let-node>
            <svg:g class="node" ngx-tooltip [tooltipPlacement]="'top'" [tooltipType]="'tooltip'"
              [tooltipTitle]="node.tooltipPosition">
              <svg:rect [attr.width]="node.dimension.width" [attr.height]="node.dimension.height" rx="10" ry="10"
                fill="#f1f3f5" stroke="#0d6efd" stroke-width="2" />


              <svg:text [attr.x]="node.dimension.width / 2" [attr.y]="node.dimension.height - 10" text-anchor="middle"
                alignment-baseline="middle" font-size="10" fill="#555">
                ðŸ‘¤ {{ node.data?.actor }}
              </svg:text>


              <svg:text text-anchor="middle" alignment-baseline="middle" font-size="12"
                [attr.x]="node.dimension.width / 2" [attr.y]="20">
                <tspan *ngFor="let line of wrapText(node.label, 20); let i = index" [attr.x]="node.dimension.width / 2"
                  [attr.dy]="i === 0 ? 0 : 15">
                  {{ line }}
                </tspan>
              </svg:text>
            </svg:g>
          </ng-template>

          <!-- Link -->
          <ng-template #linkTemplate let-link>
            <svg:g class="edge">
              <svg:path class="line" stroke-width="2" stroke="#6c757d" marker-end="url(#arrow)" />
              <svg:text class="edge-label" text-anchor="middle">
                <textPath style="fill: #495057;" [attr.href]="'#' + link.id" startOffset="60%">
                  {{ link.label }}
                </textPath>
              </svg:text>
            </svg:g>
          </ng-template>
        </ngx-graph>
      </div>
    </div>
  </main>
</div>